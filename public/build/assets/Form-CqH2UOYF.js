import{k as b,C as I,Q as N,m as F,D as _,f as d,a as y,u as r,w as x,F as k,o as l,Z as h,b as s,i as m,E as j,G as B,t as p,g as v,A as u,S as w}from"./app-gyy7AzGw.js";import{_ as T}from"./AuthenticatedLayout-ejZzCHZw.js";import{d as U}from"./index-BTWyWh5k.js";import"./ApplicationLogo--aYsc0Kz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},L={key:0},R={key:1},W={class:"devices__create"},q={class:"devices__create__cardWrapper mt-2"},G={class:"devices__create__main"},O={class:"devices__create__main--addInfo card py-2 px-2 bg-white"},Q=["value"],Z={key:0,style:{color:"red"}},z={key:1,style:{color:"red"}},H={key:2,style:{color:"red"}},J={key:3,style:{color:"red"}},K={class:"devices__create__main--media--images mt-2"},P={class:"devices__create__main--media--images--list list-unstyled"},X={class:"devices__create__main--media--images--item"},Y={class:"devices__create__main--media--images--item--imgWrapper"},ee=["src"],se={class:"devices__create__main--media--images--item"},te={class:"devices__create__main--media--images--item--form"},me={__name:"Form",setup(ie){const g=b(),t=I({user_id:"",brand:"",model_name:"",model_number:"",serial_number:"",imei:"",description:"",image:""}),c=N(),f=b(!1);let n=b([]);F(()=>{c.props.route&&c.props.route.name==="devices.edit"?(f.value=!0,g.value=c.props.route.params.id,D()):V()});const V=async()=>{try{let a=await _.get("/api/devices/create");c.props.users=a.data.users}catch(a){console.error("Error fetching users:",a)}},D=async()=>{try{let a=await _.get(`/api/devices/${g.value}/edit`);a.data.device&&(t.user_id=a.data.device.user_id,t.brand=a.data.device.brand,t.model_name=a.data.device.model_name,t.model_number=a.data.device.model_number,t.serial_number=a.data.device.serial_number,t.imei=a.data.device.imei,t.description=a.data.device.description,t.image=a.data.device.image),a.data.users&&(c.props.users=a.data.users)}catch(a){console.error("Error fetching device data:",a)}},A=()=>{let a="/upload/no-image.jpg";return t.image&&(t.image.indexOf("base64")!=-1?a=t.image:a="/upload/"+t.image),a},E=a=>{const e=a.target;let i=e.files?e.files[0]:null;if(i){const o=new FileReader;o.onloadend=ae=>{o.result&&(t.image=o.result)},o.readAsDataURL(i)}},M=(a,e)=>{f.value?C():S()},S=(a,e)=>{_.post("/api/devices",t).then(i=>{w.fire({icon:"success",title:"Appareil ajouté"}),setTimeout(()=>{U.Inertia.visit("/devices/index/")},2e3)}).catch(i=>{i.response&&i.response.status===422?n.value=i.response.data.errors:console.error("Error creating device:",i)})},C=(a,e)=>{_.put(`/api/devices/${g.value}`,t).then(i=>{w.fire({icon:"success",title:"Appareil modifié"}),setTimeout(()=>{U.Inertia.visit("/devices/index/")},2e3)}).catch(i=>{i.response.status===422?n.value=i.response.data.errors:console.error("Error creating device:",i)})};return(a,e)=>(l(),d(k,null,[y(r(h),{title:"Enregistrement Appareil"}),y(T,null,{header:x(()=>[s("h2",$,[f.value?(l(),d("span",L,"Modification d'un appareil")):(l(),d("span",R,"Nouvel Appareil"))])]),default:x(()=>[s("div",W,[e[16]||(e[16]=s("div",{class:"devices__create__titlebar dflex justify-content-between align-items-center"},[s("div",{class:"devices__create__titlebar--item"},[s("button",{class:"btn btn-secondary ml-1"},"Save")])],-1)),s("div",q,[s("div",G,[s("div",O,[e[8]||(e[8]=s("p",{class:"mb-1"},"Utilisateur",-1)),m(s("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>t.user_id=i),class:"input",id:"user_id",name:"user_id"},[(l(!0),d(k,null,B(r(c).props.users,(i,o)=>(l(),d("option",{key:o,value:o},p(i),9,Q))),128))],512),[[j,t.user_id]]),r(n).user_id?(l(),d("small",Z,p(r(n).user_id),1)):v("",!0),e[9]||(e[9]=s("p",{class:"mb-1"},"Marque",-1)),m(s("input",{type:"text",class:"input",id:"brand",name:"brand","onUpdate:modelValue":e[1]||(e[1]=i=>t.brand=i)},null,512),[[u,t.brand]]),r(n).brand?(l(),d("small",z,p(r(n).brand),1)):v("",!0),e[10]||(e[10]=s("p",{class:"mb-1"},"Modèle",-1)),m(s("input",{type:"text",class:"input",id:"model_name",name:"model_name","onUpdate:modelValue":e[2]||(e[2]=i=>t.model_name=i)},null,512),[[u,t.model_name]]),r(n).model_name?(l(),d("small",H,p(r(n).model_name),1)):v("",!0),e[11]||(e[11]=s("p",{class:"mb-1"},"No de modèle",-1)),m(s("input",{type:"text",class:"input",id:"model_number",name:"model_number","onUpdate:modelValue":e[3]||(e[3]=i=>t.model_number=i)},null,512),[[u,t.model_number]]),e[12]||(e[12]=s("p",{class:"mb-1"},"No de série",-1)),m(s("input",{type:"text",class:"input",id:"serial_number",name:"serial_number","onUpdate:modelValue":e[4]||(e[4]=i=>t.serial_number=i)},null,512),[[u,t.serial_number]]),e[13]||(e[13]=s("p",{class:"mb-1"},"imei",-1)),m(s("input",{type:"text",class:"input",id:"imei",name:"imei","onUpdate:modelValue":e[5]||(e[5]=i=>t.imei=i)},null,512),[[u,t.imei]]),e[14]||(e[14]=s("p",{class:"my-1"},"Description (optional)",-1)),m(s("textarea",{cols:"10",rows:"5",class:"textarea",id:"description",name:"description","onUpdate:modelValue":e[6]||(e[6]=i=>t.description=i)},null,512),[[u,t.description]]),r(n).description?(l(),d("small",J,p(r(n).description),1)):v("",!0),s("div",K,[s("ul",P,[s("li",X,[s("div",Y,[s("img",{src:A(),class:"devices__create__main--media--images--item--img",alt:""},null,8,ee)])]),s("li",se,[s("form",te,[e[7]||(e[7]=s("label",{class:"devices__create__main--media--images--item--form--label",for:"myfile"},"Add Image",-1)),s("input",{class:"devices__create__main--media--images--item--form--input",type:"file",id:"myfile",onChange:E},null,32)])])])])])])]),s("div",{class:"dflex justify-content-between align-items-center my-3"},[e[15]||(e[15]=s("p",null,null,-1)),s("button",{class:"btn btn-secondary",onClick:M},"Save")])])]),_:1})],64))}};export{me as default};
