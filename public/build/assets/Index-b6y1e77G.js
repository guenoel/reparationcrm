import{Q as $,k as d,m as T,l as V,D as f,f as i,a as x,u as p,w as y,F as _,o,Z as E,b as t,i as C,A as F,H as M,g as h,G as k,E as I,d as a,t as n,n as N}from"./app-Dkm1rt9V.js";import{_ as A}from"./AuthenticatedLayout-CixOTf3m.js";import{d as H}from"./index-CLCCGICM.js";import"./ApplicationLogo-mZEy1bWB.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},Q={class:"devices__list table"},U={class:"relative"},Y={class:"table--heading mt-2 spares__list__heading",style:{"padding-top":"20px",background:"#FFF"}},R={key:0,class:"table--heading--col8"},j=["src"],z={key:0},G=["onClick"],Z=["onClick"],q={class:"table--items devices__list__bottom"},J={class:"pagination"},K=["innerHTML","onClick"],ne={__name:"Index",setup(O){const w=$();let c=d([]),m=d([]),r=d("");const v=d(!1),b=d(10);T(async()=>{const l=w.props.auth.user;l&&l.role===0&&(v.value=!0),u()}),V(r,()=>{u()});const D=l=>"/upload/"+l,u=async()=>{try{const l=await f.get(`/api/spares?searchQuery=${r.value}&perPage=${b.value}`);c.value=l.data.spares.data,m.value=l.data.spares.links}catch(l){console.error("Error fetching spares:",l)}},B=l=>{!l.url||l.active||f.get(l.url).then(e=>{c.value=e.data.spares.data,m.value=e.data.spares.links})},P=l=>{H.Inertia.visit(`/spares/${l}/edit`)},S=l=>{Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(e=>{e.isConfirmed&&f.delete(`/api/spares/${l}`).then(()=>{Swal.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"}),u()})})};return(l,e)=>(o(),i(_,null,[x(p(E),{title:"Enregistrement pièce"}),x(A,null,{header:y(()=>e[2]||(e[2]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},[t("span",null,"Pièces")],-1)])),default:y(()=>[t("div",L,[t("div",Q,[e[19]||(e[19]=t("div",{class:"customers__titlebar dflex justify-content-between align-items-center"},[t("div",{class:"customers__titlebar--item"},[t("h1",null,"Pièces")])],-1)),t("div",U,[C(t("input",{class:"search-input",type:"text",name:"search",placeholder:"Recherche pièce...","onUpdate:modelValue":e[0]||(e[0]=s=>M(r)?r.value=s:r=s)},null,512),[[F,p(r)]])]),t("div",Y,[e[3]||(e[3]=t("p",{class:"table--heading--col1"},"Image",-1)),e[4]||(e[4]=t("p",{class:"table--heading--col2"},"Prestation",-1)),e[5]||(e[5]=t("p",{class:"table--heading--col3"},"Type de pièce",-1)),e[6]||(e[6]=t("p",{class:"table--heading--col4"},"Description",-1)),e[7]||(e[7]=t("p",{class:"table--heading--col5"},"Date de commande",-1)),e[8]||(e[8]=t("p",{class:"table--heading--col6"},"Date de reception",-1)),e[9]||(e[9]=t("p",{class:"table--heading--col7"},"Date de retour",-1)),v.value?h("",!0):(o(),i("p",R,"Actions"))]),(o(!0),i(_,null,k(p(c),s=>(o(),i("div",{class:"table--items spares__list__item",key:s.id},[t("img",{src:D(s.image)},null,8,j),t("p",null,[a(n(s.service.device.user.name)+" -> "+n(s.service.device.brand)+" "+n(s.service.device.model_name),1),e[10]||(e[10]=t("br",null,null,-1)),a("-> "+n(s.service.description),1)]),t("p",null,[a(n(s.spare_type.dealer),1),e[11]||(e[11]=t("br",null,null,-1)),a(n(s.spare_type.type),1),e[12]||(e[12]=t("br",null,null,-1)),a(n(s.spare_type.brand),1)]),t("p",null,n(s.description),1),t("p",null,[a(n(s.formatted_purchase_date),1),e[13]||(e[13]=t("br",null,null,-1)),a(" "+n(s.formatted_purchase_time),1)]),t("p",null,[a(n(s.formatted_reception_date),1),e[14]||(e[14]=t("br",null,null,-1)),a(" "+n(s.formatted_reception_time),1)]),t("p",null,[a(n(s.formatted_return_date),1),e[15]||(e[15]=t("br",null,null,-1)),a(" "+n(s.formatted_return_time),1)]),v.value?h("",!0):(o(),i("div",z,[t("button",{class:"btn-icon btn-icon-success",onClick:g=>P(s.id)},e[16]||(e[16]=[t("i",{class:"fas fa-pencil-alt"},null,-1)]),8,G),t("button",{class:"btn-icon btn-icon-danger",onClick:g=>S(s.id)},e[17]||(e[17]=[t("i",{class:"far fa-trash-alt"},null,-1)]),8,Z)]))]))),128)),t("div",q,[t("ul",J,[(o(!0),i(_,null,k(p(m),(s,g)=>(o(),i("a",{href:"#",class:N(["btn btn-secondary",{active:s.active,disable:!s.url}]),key:g,innerHTML:s.label,onClick:W=>B(s)},null,10,K))),128))]),C(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>b.value=s),onChange:u,class:"select-pagination"},e[18]||(e[18]=[t("option",{value:"5"},"5",-1),t("option",{value:"10"},"10",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1),t("option",{value:"200"},"200",-1),t("option",{value:"500"},"500",-1),t("option",{value:"1000"},"1000",-1)]),544),[[I,b.value]])])])])]),_:1})],64))}};export{ne as default};
