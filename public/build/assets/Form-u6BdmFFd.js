import{k as f,C as M,Q as j,m as N,D as m,f as n,a as h,u as r,w as b,F as k,o as l,Z as B,b as t,i as _,E as x,G as w,t as c,g as p,A as y,S}from"./app-C9vR_Gzm.js";import{_ as $}from"./AuthenticatedLayout-DGMLU6Id.js";import{d as E}from"./index-D1IcRyCj.js";import"./ApplicationLogo-A6nw8Az8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},R={key:0},W={key:1},G={class:"tasks__create"},O={class:"tasks__create__cardWrapper mt-2"},Q={class:"tasks__create__main"},Z={class:"tasks__create__main--addInfo card py-2 px-2 bg-white"},q=["value"],z={key:0,style:{color:"red"}},H=["value"],J={key:1,style:{color:"red"}},K={key:2,style:{color:"red"}},P={key:3,style:{color:"red"}},X={key:4,style:{color:"red"}},Y={class:"devices__create__main--media--images mt-2"},ee={class:"devices__create__main--media--images--list list-unstyled"},se={class:"devices__create__main--media--images--item"},te={class:"devices__create__main--media--images--item--imgWrapper"},ae=["src"],ie={class:"devices__create__main--media--images--item"},re={class:"devices__create__main--media--images--item--form"},pe={__name:"Form",setup(oe){const v=f(),i=M({service_id:"",user_id:"",start:"",end:"",description:""}),d=j(),g=f(!1);let o=f([]);N(()=>{d.props.route&&d.props.route.name==="tasks.edit"?(g.value=!0,v.value=d.props.route.params.id,I()):(V(),D())});const V=async()=>{try{let a=await m.get("/api/services");d.props.services=a.data.services.data}catch(a){console.error("Error fetching services:",a)}},D=async()=>{try{let a=await m.get("/api/users");d.props.users=a.data.users.data}catch(a){console.error("Error fetching users:",a)}},I=async()=>{try{let a=await m.get(`/api/tasks/${v.value}/edit`);a.data.task&&(i.service_id=a.data.task.service_id,i.user_id=a.data.task.user_id,i.start=a.data.task.start,i.end=a.data.task.end,i.description=a.data.task.description),a.data.services&&(d.props.services=a.data.services)}catch(a){console.error("Error fetching task data:",a)}},T=()=>{let a="/upload/no-image.jpg";return i.image&&(i.image.indexOf("base64")!=-1?a=i.image:a="/upload/"+i.image),a},U=a=>{const e=a.target;let s=e.files?e.files[0]:null;if(s){const u=new FileReader;u.onloadend=ne=>{u.result&&(i.image=u.result)},u.readAsDataURL(s)}},C=(a,e)=>{g.value?A():F()},F=(a,e)=>{m.post("/api/tasks",i).then(s=>{S.fire({icon:"success",title:"Appareil ajouté"}),setTimeout(()=>{E.Inertia.visit("/tasks/index/")},2e3)}).catch(s=>{s.response&&s.response.status===422?o.value=s.response.data.errors:console.error("Error creating task:",s)})},A=(a,e)=>{m.put(`/api/tasks/${v.value}`,i).then(s=>{S.fire({icon:"success",title:"Appareil modifié"}),setTimeout(()=>{E.Inertia.visit("/tasks/index/")},2e3)}).catch(s=>{s.response.status===422?o.value=s.response.data.errors:console.error("Error creating task:",s)})};return(a,e)=>(l(),n(k,null,[h(r(B),{title:"Enregistrement d'une tâche"}),h($,null,{header:b(()=>[t("h2",L,[g.value?(l(),n("span",R,"Modification d'une tâche")):(l(),n("span",W,"Nouvelle tâche"))])]),default:b(()=>[t("div",G,[e[12]||(e[12]=t("div",{class:"tasks__create__titlebar dflex justify-content-between align-items-center"},[t("div",{class:"tasks__create__titlebar--item"},[t("button",{class:"btn btn-secondary ml-1"},"Save")])],-1)),t("div",O,[t("div",Q,[t("div",Z,[e[6]||(e[6]=t("p",{class:"mb-1"},"Service ID",-1)),_(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>i.service_id=s),class:"input",id:"service_id",name:"service_id"},[(l(!0),n(k,null,w(r(d).props.services,s=>(l(),n("option",{key:s.id,value:s.id},c(s.description),9,q))),128))],512),[[x,i.service_id]]),r(o).service_id?(l(),n("small",z,c(r(o).service_id),1)):p("",!0),e[7]||(e[7]=t("p",{class:"mb-1"},"Technicien",-1)),_(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>i.user_id=s),class:"input",id:"user_id",name:"user_id"},[(l(!0),n(k,null,w(r(d).props.users,s=>(l(),n("option",{key:s.id,value:s.id},c(s.name),9,H))),128))],512),[[x,i.user_id]]),r(o).user_id?(l(),n("small",J,c(r(o).user_id),1)):p("",!0),e[8]||(e[8]=t("p",{class:"mb-1"},"Début de la tâche",-1)),_(t("input",{type:"datetime-local",class:"input",id:"start",name:"start","onUpdate:modelValue":e[2]||(e[2]=s=>i.start=s)},null,512),[[y,i.start]]),r(o).start?(l(),n("small",K,c(r(o).start),1)):p("",!0),e[9]||(e[9]=t("p",{class:"mb-1"},"Fin de la tâche",-1)),_(t("input",{type:"datetime-local",class:"input",id:"end",name:"end","onUpdate:modelValue":e[3]||(e[3]=s=>i.end=s)},null,512),[[y,i.end]]),r(o).end?(l(),n("small",P,c(r(o).end),1)):p("",!0),e[10]||(e[10]=t("p",{class:"my-1"},"Description",-1)),_(t("textarea",{cols:"10",rows:"5",class:"textarea",id:"description",name:"description","onUpdate:modelValue":e[4]||(e[4]=s=>i.description=s)},null,512),[[y,i.description]]),r(o).description?(l(),n("small",X,c(r(o).description),1)):p("",!0),t("div",Y,[t("ul",ee,[t("li",se,[t("div",te,[t("img",{src:T(),class:"devices__create__main--media--images--item--img",alt:""},null,8,ae)])]),t("li",ie,[t("form",re,[e[5]||(e[5]=t("label",{class:"devices__create__main--media--images--item--form--label",for:"myfile"},"Add Image",-1)),t("input",{class:"devices__create__main--media--images--item--form--input",type:"file",id:"myfile",onChange:U},null,32)])])])])])])]),t("div",{class:"dflex justify-content-between align-items-center my-3"},[e[11]||(e[11]=t("p",null,null,-1)),t("button",{class:"btn btn-secondary",onClick:C},"Save")])])]),_:1})],64))}};export{pe as default};
