import{k as f,C as j,Q as N,m as T,D as u,f as n,a as b,u as i,w as x,F as h,o as d,Z as B,b as t,i as _,E as k,G as S,t as c,g as m,A as v,S as w}from"./app-DdsDavk_.js";import{_ as $}from"./AuthenticatedLayout-BFEIzVvK.js";import{d as D}from"./index-B1UiXECu.js";import"./ApplicationLogo-0MsJH9Fq.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},R={key:0},W={key:1},G={class:"spares__create"},O={class:"spares__create__cardWrapper mt-2"},P={class:"spares__create__main"},Q={class:"spares__create__main--addInfo card py-2 px-2 bg-white"},Z=["value"],q={key:0,style:{color:"red"}},z=["value"],H={key:1,style:{color:"red"}},J={key:2,style:{color:"red"}},K={key:3,style:{color:"red"}},X={key:4,style:{color:"red"}},Y={key:5,style:{color:"red"}},ee={class:"devices__create__main--media--images mt-2"},se={class:"devices__create__main--media--images--list list-unstyled"},te={class:"devices__create__main--media--images--item"},ae={class:"devices__create__main--media--images--item--imgWrapper"},re=["src"],ie={class:"devices__create__main--media--images--item"},oe={class:"devices__create__main--media--images--item--form"},ue={__name:"Form",setup(ne){const y=f(),r=j({image:"",service_id:"",spare_type_id:"",purchase_date:"",reception_date:"",description:""}),p=N(),g=f(!1);let o=f([]);T(()=>{p.props.route&&p.props.route.name==="spares.edit"?(g.value=!0,y.value=p.props.route.params.id,I()):(V(),E())});const V=async()=>{try{let s=await u.get("/api/spares/create");p.props.services=s.data.services}catch(s){console.error("Error fetching services:",s)}},E=async()=>{try{let s=await u.get("/api/spares/create");p.props.spare_types=s.data.spare_types}catch(s){console.error("Error fetching spare_types:",s)}},I=async()=>{try{let s=await u.get(`/api/spares/${y.value}/edit`);s.data.spare&&(r.image=s.data.spare.image,r.service_id=s.data.spare.service_id,r.spare_type_id=s.data.spare.spare_type_id,r.description=s.data.spare.description,r.purchase_date=s.data.spare.purchase_date,r.reception_date=s.data.spare.reception_date,r.return_date=s.data.spare.return_date),s.data.services&&(p.props.services=s.data.services),s.data.spare_type_id&&(p.props.spare_type_id=s.data.spare_type_id)}catch(s){console.error("Error fetching spare data:",s)}},U=()=>{let s="/upload/no-image.jpg";return r.image&&(r.image.indexOf("base64")!=-1?s=r.image:s="/upload/"+r.image),s},C=s=>{const e=s.target;let a=e.files?e.files[0]:null;if(a){const l=new FileReader;l.onloadend=de=>{l.result&&(r.image=l.result)},l.readAsDataURL(a)}},A=(s,e)=>{g.value?M():F()},F=(s,e)=>{u.post("/api/spares",r).then(a=>{w.fire({icon:"success",title:"Appareil ajouté"}),setTimeout(()=>{D.Inertia.visit("/spares/index/")},2e3)}).catch(a=>{a.response&&a.response.status===422?o.value=a.response.data.errors:console.error("Error creating spare:",a)})},M=(s,e)=>{u.put(`/api/spares/${y.value}`,r).then(a=>{w.fire({icon:"success",title:"Appareil modifié"}),setTimeout(()=>{D.Inertia.visit("/spares/index/")},2e3)}).catch(a=>{a.response.status===422?o.value=a.response.data.errors:console.error("Error creating spare:",a)})};return(s,e)=>(d(),n(h,null,[b(i(B),{title:"Enregistrement d'une pièce"}),b($,null,{header:x(()=>[t("h2",L,[g.value?(d(),n("span",R,"Modification d'une pièce")):(d(),n("span",W,"Nouvelle pièce"))])]),default:x(()=>[t("div",G,[e[14]||(e[14]=t("div",{class:"spares__create__titlebar dflex justify-content-between align-items-center"},[t("div",{class:"spares__create__titlebar--item"},[t("button",{class:"btn btn-secondary ml-1"},"Save")])],-1)),t("div",O,[t("div",P,[t("div",Q,[e[7]||(e[7]=t("p",{class:"mb-1"},"Service ID",-1)),_(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.service_id=a),class:"input",id:"service_id",name:"service_id"},[(d(!0),n(h,null,S(i(p).props.services,(a,l)=>(d(),n("option",{key:l,value:l},c(a),9,Z))),128))],512),[[k,r.service_id]]),i(o).service_id?(d(),n("small",q,c(i(o).service_id),1)):m("",!0),e[8]||(e[8]=t("p",{class:"mb-1"},"Pièce type ID",-1)),_(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>r.spare_type_id=a),class:"input",id:"spare_type_id",name:"spare_type_id"},[(d(!0),n(h,null,S(i(p).props.spare_types,(a,l)=>(d(),n("option",{key:l,value:l},c(a),9,z))),128))],512),[[k,r.spare_type_id]]),i(o).spare_type_id?(d(),n("small",H,c(i(o).spare_type_id),1)):m("",!0),e[9]||(e[9]=t("p",{class:"my-1"},"Description",-1)),_(t("textarea",{cols:"10",rows:"5",class:"textarea",id:"description",name:"description","onUpdate:modelValue":e[2]||(e[2]=a=>r.description=a)},null,512),[[v,r.description]]),i(o).description?(d(),n("small",J,c(i(o).description),1)):m("",!0),e[10]||(e[10]=t("p",{class:"mb-1"},"Date d'achat",-1)),_(t("input",{type:"datetime-local",class:"input",id:"purchase_date",name:"purchase_date","onUpdate:modelValue":e[3]||(e[3]=a=>r.purchase_date=a)},null,512),[[v,r.purchase_date]]),i(o).purchase_date?(d(),n("small",K,c(i(o).purchase_date),1)):m("",!0),e[11]||(e[11]=t("p",{class:"mb-1"},"Date de reception",-1)),_(t("input",{type:"datetime-local",class:"input",id:"reception_date",name:"reception_date","onUpdate:modelValue":e[4]||(e[4]=a=>r.reception_date=a)},null,512),[[v,r.reception_date]]),i(o).reception_date?(d(),n("small",X,c(i(o).reception_date),1)):m("",!0),e[12]||(e[12]=t("p",{class:"mb-1"},"Date de retour",-1)),_(t("input",{type:"datetime-local",class:"input",id:"return_date",name:"return_date","onUpdate:modelValue":e[5]||(e[5]=a=>r.return_date=a)},null,512),[[v,r.return_date]]),i(o).return_date?(d(),n("small",Y,c(i(o).return_date),1)):m("",!0),t("div",ee,[t("ul",se,[t("li",te,[t("div",ae,[t("img",{src:U(),class:"devices__create__main--media--images--item--img",alt:""},null,8,re)])]),t("li",ie,[t("form",oe,[e[6]||(e[6]=t("label",{class:"devices__create__main--media--images--item--form--label",for:"myfile"},"Add Image",-1)),t("input",{class:"devices__create__main--media--images--item--form--input",type:"file",id:"myfile",onChange:C},null,32)])])])])])])]),t("div",{class:"dflex justify-content-between align-items-center my-3"},[e[13]||(e[13]=t("p",null,null,-1)),t("button",{class:"btn btn-secondary",onClick:A},"Save")])])]),_:1})],64))}};export{ue as default};
