import{k as _,C,Q as M,m as N,D as m,f as r,a as g,u as n,w as b,F as x,o,Z as A,b as i,i as f,E as T,G as F,t as v,g as d,A as h,v as I,d as j,S as k}from"./app-C9vR_Gzm.js";import{_ as B}from"./AuthenticatedLayout-DGMLU6Id.js";import{d as w}from"./index-D1IcRyCj.js";import"./ApplicationLogo-A6nw8Az8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},L={key:0},P={key:1},R={class:"services__create"},z={class:"services__create__cardWrapper mt-2"},G={class:"services__create__main"},J={class:"services__create__main--addInfo card py-2 px-2 bg-white"},O=["value"],Q={key:0,style:{color:"red"}},W={key:1,style:{color:"red"}},Z={key:2},q={key:0,style:{color:"red"}},H={key:3},K={class:"my-1"},X={key:4},Y={key:5},ee={class:"mb-1"},se={key:6},ne={__name:"Form",setup(te){const y=_(),t=C({device_id:"",description:"",price:null,accepted:!1}),l=M(),p=_(!1);let c=_([]);const u=_(!1);N(()=>{const a=l.props.auth.user;a&&a.role===0&&(u.value=!0),l.props.route&&l.props.route.name==="services.edit"?(p.value=!0,y.value=l.props.route.params.id,D()):S()});const S=async()=>{try{let a=await m.get("/api/devices");console.log("Devices Response:",a.data.devices.data),l.props.devices=a.data.devices.data;const e=new URLSearchParams(window.location.search);t.device_id=e.get("device_id")}catch(a){console.error("Error fetching devices:",a)}},D=async()=>{try{let a=await m.get(`/api/services/${y.value}/edit`);a.data.service&&(t.device_id=a.data.service.device_id,t.description=a.data.service.description,t.price=a.data.service.price,t.accepted=a.data.service.accepted),a.data.devices&&(l.props.devices=a.data.devices)}catch(a){console.error("Error fetching service data:",a)}},E=(a,e)=>{p.value?U():V()},V=(a,e)=>{m.post("/api/services",t).then(s=>{k.fire({icon:"success",title:"Appareil ajouté"}),setTimeout(()=>{w.Inertia.visit("/services/index/")},2e3)}).catch(s=>{s.response&&s.response.status===422?c.value=s.response.data.errors:console.error("Error creating service:",s)}),console.log("Form data being sent:",JSON.stringify(t,null,2))},U=(a,e)=>{m.put(`/api/services/${y.value}`,t).then(s=>{k.fire({icon:"success",title:"Appareil modifié"}),setTimeout(()=>{w.Inertia.visit("/services/index/")},2e3)}).catch(s=>{s.response.status===422?c.value=s.response.data.errors:console.error("Error creating service:",s)})};return(a,e)=>(o(),r(x,null,[g(n(A),{title:"Enregistrement Appareil"}),g(B,null,{header:b(()=>[i("h2",$,[p.value?(o(),r("span",L,"Modification d'une prestation")):(o(),r("span",P,"Nouvelle prestation"))])]),default:b(()=>[i("div",R,[e[11]||(e[11]=i("div",{class:"services__create__titlebar dflex justify-content-between align-items-center"},[i("div",{class:"services__create__titlebar--item"},[i("button",{class:"btn btn-secondary ml-1"},"Save")])],-1)),i("div",z,[i("div",G,[i("div",J,[e[8]||(e[8]=i("p",{class:"mb-1"},"Appareil",-1)),f(i("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>t.device_id=s),class:"input",id:"device_id",name:"device_id"},[(o(!0),r(x,null,F(n(l).props.devices,s=>(o(),r("option",{key:s.id,value:s.id},v(s.brand)+" "+v(s.model_name),9,O))),128))],512),[[T,t.device_id]]),n(c).device_id?(o(),r("small",Q,v(n(c).device_id),1)):d("",!0),e[9]||(e[9]=i("p",{class:"my-1"},"Description du service demandé",-1)),f(i("textarea",{cols:"10",rows:"5",class:"textarea",id:"description",name:"description","onUpdate:modelValue":e[1]||(e[1]=s=>t.description=s)},null,512),[[h,t.description]]),n(c).description?(o(),r("small",W,v(n(c).description),1)):d("",!0),u.value?d("",!0):(o(),r("div",Z,[e[4]||(e[4]=i("p",{class:"mb-1"},"Prix",-1)),f(i("input",{type:"text",class:"input",id:"price",name:"price","onUpdate:modelValue":e[2]||(e[2]=s=>t.price=s)},null,512),[[h,t.price]]),n(c).price?(o(),r("small",q,v(n(c).price),1)):d("",!0)])),u.value&&p.value&&t.price!=null?(o(),r("div",H,[i("p",K,"Tarif: "+v(t.price),1)])):d("",!0),p.value&&t.price==null?(o(),r("div",X,e[5]||(e[5]=[i("p",{class:"mb-1"},"En attente d'un tarif",-1)]))):d("",!0),u.value&&p.value&&t.accepted==!1&&t.price!=null?(o(),r("div",Y,[i("p",ee,[f(i("input",{type:"checkbox",id:"accepted",name:"accepted","onUpdate:modelValue":e[3]||(e[3]=s=>t.accepted=s)},null,512),[[I,t.accepted]]),e[6]||(e[6]=j(" Cochez la case pour accepter le devis"))])])):d("",!0),u.value&&p.value&&t.accepted==!0?(o(),r("div",se,e[7]||(e[7]=[i("p",{class:"my-1"},"Devis accepté",-1)]))):d("",!0)])])]),i("div",{class:"dflex justify-content-between align-items-center my-3"},[e[10]||(e[10]=i("p",null,null,-1)),i("button",{class:"btn btn-secondary",onClick:E},"Save")])])]),_:1})],64))}};export{ne as default};
