import{k as _,C as M,Q as N,m as A,D as m,f as r,a as x,u as n,w as b,F as h,o,Z as T,b as t,i as f,E as F,G as I,t as u,g as d,A as k,v as j,d as B,S as w}from"./app-BOCkaKV8.js";import{_ as $}from"./AuthenticatedLayout-D_9LhWXv.js";import{d as S}from"./index-Ps8C63Ky.js";import"./ApplicationLogo-DHmw7JHb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},P={key:0},z={key:1},G={class:"services__create"},J={class:"services__create__cardWrapper mt-2"},O={class:"services__create__main"},Q={class:"services__create__main--addInfo card py-2 px-2 bg-white"},R=["value"],W={key:0,style:{color:"red"}},Z={key:1,style:{color:"red"}},q={key:2},H={key:0,style:{color:"red"}},K={key:3},X={class:"my-1"},Y={key:4},ee={key:5},se={class:"mb-1"},te={key:6},de={__name:"Form",setup(ie){const y=_(),s=M({device_id:"",description:"",price:null,accepted:!1}),l=N(),p=_(!1);let c=_([]);const v=_(!1);A(()=>{const i=l.props.auth.user;i&&i.role===0&&(v.value=!0),l.props.route&&l.props.route.name==="services.edit"?(p.value=!0,y.value=l.props.route.params.id,V()):E()});const E=async()=>{try{let i=await m.get("/api/services/create");l.props.devices=i.data.devices;const e=new URLSearchParams(window.location.search);s.device_id=e.get("device_id")}catch(i){console.error("Error fetching devices:",i)}},V=async()=>{try{let i=await m.get(`/api/services/${y.value}/edit`);i.data.service&&(s.device_id=i.data.service.device_id,s.description=i.data.service.description,s.price=i.data.service.price,s.accepted=i.data.service.accepted),i.data.devices&&(l.props.devices=i.data.devices)}catch(i){console.error("Error fetching service data:",i)}},D=(i,e)=>{p.value?C():U()},U=(i,e)=>{m.post("/api/services",s).then(a=>{w.fire({icon:"success",title:"Appareil ajouté"}),setTimeout(()=>{S.Inertia.visit("/services/index/")},2e3)}).catch(a=>{a.response&&a.response.status===422?c.value=a.response.data.errors:console.error("Error creating service:",a)}),console.log("Form data being sent:",JSON.stringify(s,null,2))},C=(i,e)=>{m.put(`/api/services/${y.value}`,s).then(a=>{w.fire({icon:"success",title:"Appareil modifié"}),setTimeout(()=>{S.Inertia.visit("/services/index/")},2e3)}).catch(a=>{a.response.status===422?c.value=a.response.data.errors:console.error("Error creating service:",a)})};return(i,e)=>(o(),r(h,null,[x(n(T),{title:"Enregistrement Appareil"}),x($,null,{header:b(()=>[t("h2",L,[p.value?(o(),r("span",P,"Modification d'une prestation")):(o(),r("span",z,"Nouvelle prestation"))])]),default:b(()=>[t("div",G,[e[11]||(e[11]=t("div",{class:"services__create__titlebar dflex justify-content-between align-items-center"},[t("div",{class:"services__create__titlebar--item"},[t("button",{class:"btn btn-secondary ml-1"},"Save")])],-1)),t("div",J,[t("div",O,[t("div",Q,[e[8]||(e[8]=t("p",{class:"mb-1"},"Appareil",-1)),f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.device_id=a),class:"input",id:"device_id",name:"device_id"},[(o(!0),r(h,null,I(n(l).props.devices,(a,g)=>(o(),r("option",{key:g,value:g},u(a),9,R))),128))],512),[[F,s.device_id]]),n(c).device_id?(o(),r("small",W,u(n(c).device_id),1)):d("",!0),e[9]||(e[9]=t("p",{class:"my-1"},"Description du service demandé",-1)),f(t("textarea",{cols:"10",rows:"5",class:"textarea",id:"description",name:"description","onUpdate:modelValue":e[1]||(e[1]=a=>s.description=a)},null,512),[[k,s.description]]),n(c).description?(o(),r("small",Z,u(n(c).description),1)):d("",!0),v.value?d("",!0):(o(),r("div",q,[e[4]||(e[4]=t("p",{class:"mb-1"},"Prix",-1)),f(t("input",{type:"text",class:"input",id:"price",name:"price","onUpdate:modelValue":e[2]||(e[2]=a=>s.price=a)},null,512),[[k,s.price]]),n(c).price?(o(),r("small",H,u(n(c).price),1)):d("",!0)])),v.value&&p.value&&s.price!=null?(o(),r("div",K,[t("p",X,"Tarif: "+u(s.price),1)])):d("",!0),p.value&&s.price==null?(o(),r("div",Y,e[5]||(e[5]=[t("p",{class:"mb-1"},"En attente d'un tarif",-1)]))):d("",!0),v.value&&p.value&&s.accepted==!1&&s.price!=null?(o(),r("div",ee,[t("p",se,[f(t("input",{type:"checkbox",id:"accepted",name:"accepted","onUpdate:modelValue":e[3]||(e[3]=a=>s.accepted=a)},null,512),[[j,s.accepted]]),e[6]||(e[6]=B(" Cochez la case pour accepter le devis"))])])):d("",!0),v.value&&p.value&&s.accepted==!0?(o(),r("div",te,e[7]||(e[7]=[t("p",{class:"my-1"},"Devis accepté",-1)]))):d("",!0)])])]),t("div",{class:"dflex justify-content-between align-items-center my-3"},[e[10]||(e[10]=t("p",null,null,-1)),t("button",{class:"btn btn-secondary",onClick:D},"Save")])])]),_:1})],64))}};export{de as default};
