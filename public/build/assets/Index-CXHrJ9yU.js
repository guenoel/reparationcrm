import{Q as j,k as p,m as I,l as L,h as H,D as x,f as o,a as v,u as g,w as m,F as $,o as r,Z as Q,b as t,i as T,A as R,H as Y,n as s,E as F,G as q,t as d,g as k,j as h,d as w,e as z}from"./app-BrQThaKp.js";import{_ as G}from"./AuthenticatedLayout-BzilsnKP.js";import{d as N}from"./index-Br-uvqLY.js";import"./ApplicationLogo-D5-q05GN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},J={class:"devices__list table"},K={class:"relative"},O={class:"legend--services"},W=["onClick"],X=["onClick"],ee={key:0},te={key:1},ne={key:2},ae={class:"table--items devices__list__bottom"},le={class:"pagination"},se=["innerHTML","onClick"],ge={__name:"Index",setup(ie){const M=j();let f=p([]),_=p([]),u=p("");const b=p(!1),l=p([]),C=p(10);I(async()=>{const e=M.props.auth.user;e&&e.role===0&&(b.value=!0),y()}),L(u,()=>{y()});const P=e=>!e.price_paid&&!e.accepted&&!e.done&&e.returned?"bg-gray-200":!e.price_paid&&!e.accepted&&!e.done&&!e.returned?"bg-orange-300":e.price_paid&&!e.accepted&&!e.done&&!e.returned?"bg-orange-500":!e.price_paid&&e.accepted&&!e.done&&!e.returned?"bg-blue-300":e.price_paid&&e.accepted&&!e.done&&!e.returned?"bg-blue-500":!e.price_paid&&e.accepted&&e.done&&!e.returned?"bg-green-300":e.price_paid&&e.accepted&&e.done&&!e.returned?"bg-green-700":e.price_paid&&e.accepted&&e.done&&e.returned?"bg-gray-500":!e.price_paid&&e.accepted&&e.done&&e.returned?"bg-red-500":"",S=H(()=>l.value.length===0?f.value:f.value.filter(e=>l.value.includes(P(e)))),i=e=>{l.value.includes(e)?l.value=l.value.filter(n=>n!==e):l.value.push(e)},y=async()=>{try{const e=await x.get(`/api/services?searchQuery=${u.value}&perPage=${C.value}`);f.value=e.data.services.data,_.value=e.data.services.links}catch(e){console.error("Error fetching services:",e)}},B=e=>{N.Inertia.visit(`/tasks/create?service_id=${e}`)},D=e=>{N.Inertia.visit(`/spares/create?service_id=${e}`)},V=e=>{!e.url||e.active||x.get(e.url).then(n=>{f.value=n.data.services.data,_.value=n.data.services.links})},A=e=>{N.Inertia.visit(`/services/${e}/edit`)},E=e=>{Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(n=>{n.isConfirmed&&x.delete(`/api/services/${e}`).then(()=>{Swal.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"}),y()})})},U=e=>{window.open(`/services/${e}/ticket`,"_blank")};return(e,n)=>(r(),o($,null,[v(g(Q),{title:"Enregistrement prestation"}),v(G,null,{header:m(()=>n[11]||(n[11]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},[t("span",null,"Prestations")],-1)])),default:m(()=>[t("div",Z,[t("div",J,[n[18]||(n[18]=t("div",{class:"customers__titlebar dflex justify-content-between align-items-center"},[t("div",{class:"customers__titlebar--item"},[t("h1",null,"Prestations")])],-1)),t("div",K,[T(t("input",{class:"search-input",type:"text",name:"search",placeholder:"Recherche prestation...","onUpdate:modelValue":n[0]||(n[0]=a=>Y(u)?u.value=a:u=a)},null,512),[[R,g(u)]])]),n[19]||(n[19]=t("div",{class:"legend--title"},[t("p",null,"Légende et filtre:")],-1)),t("div",O,[t("span",{class:s(["bg-orange-300",{"active-filter":l.value.includes("bg-orange-300")}]),onClick:n[1]||(n[1]=a=>i("bg-orange-300"))}," Non payé, non accepté, non terminé, non rendu ",2),t("span",{class:s(["bg-orange-500",{"active-filter":l.value.includes("bg-orange-500")}]),onClick:n[2]||(n[2]=a=>i("bg-orange-500"))}," Payé, non accepté, non terminé, non rendu ",2),t("span",{class:s(["bg-red-500",{"active-filter":l.value.includes("bg-red-500")}]),onClick:n[3]||(n[3]=a=>i("bg-red-500"))}," Non payé, accepté, terminé, rendu ",2),t("span",{class:s(["bg-blue-300",{"active-filter":l.value.includes("bg-blue-300")}]),onClick:n[4]||(n[4]=a=>i("bg-blue-300"))}," Non Payé, accepté, non terminé, non rendu ",2),t("span",{class:s(["bg-blue-500",{"active-filter":l.value.includes("bg-blue-500")}]),onClick:n[5]||(n[5]=a=>i("bg-blue-500"))}," Payé, accepté, non terminé, non rendu ",2),t("span",{class:s(["bg-gray-200",{"active-filter":l.value.includes("bg-gray-200")}]),onClick:n[6]||(n[6]=a=>i("bg-gray-200"))}," Non payé, non accepté, non terminé, rendu ",2),t("span",{class:s(["bg-green-300",{"active-filter":l.value.includes("bg-green-300")}]),onClick:n[7]||(n[7]=a=>i("bg-green-300"))}," Non payé, accepté, terminé, non rendu ",2),t("span",{class:s(["bg-green-700",{"active-filter":l.value.includes("bg-green-700")}]),onClick:n[8]||(n[8]=a=>i("bg-green-700"))}," Payé, accepté, terminé, non rendu ",2),t("span",{class:s(["bg-gray-500",{"active-filter":l.value.includes("bg-gray-500")}]),onClick:n[9]||(n[9]=a=>i("bg-gray-500"))}," Payé, accepté, terminé, rendu ",2)]),n[20]||(n[20]=t("div",{class:"table--heading mt-2 services__list__heading",style:{"padding-top":"20px",background:"#FFF"}},[t("p",{class:"table--heading--col1"},"Utilisateur"),t("p",{class:"table--heading--col2"},"Marque"),t("p",{class:"table--heading--col3"},"Nom Modèle"),t("p",{class:"table--heading--col4"},"No Modèle"),t("p",{class:"table--heading--col5"},"No Serie"),t("p",{class:"table--heading--col6"},"Description de la prestation"),t("p",{class:"table--heading--col7"},"Prix"),t("p",{class:"table--heading--col8"},"Actions")],-1)),(r(!0),o($,null,F(S.value,a=>(r(),o("div",{class:s(["table--items services__list__item",P(a)]),key:a.id},[t("p",null,d(a.device.user.name),1),t("p",null,d(a.device.brand),1),t("p",null,d(a.device.model_name),1),t("p",null,d(a.device.model_number),1),t("p",null,d(a.device.serial_number),1),t("p",null,d(a.description),1),t("p",null,d(a.price),1),t("div",null,[t("button",{class:"btn-icon btn-icon-success",onClick:c=>A(a.id)},n[12]||(n[12]=[t("i",{class:"fas fa-pencil-alt"},null,-1)]),8,W),!b.value||!a.price?(r(),o("button",{key:0,class:"btn-icon btn-icon-danger",onClick:c=>E(a.id)},n[13]||(n[13]=[t("i",{class:"far fa-trash-alt"},null,-1)]),8,X)):k("",!0)]),b.value?k("",!0):(r(),o("div",ee,[v(g(h),{href:"/tasks/create",class:"btn btn-secondary my-1",onClick:c=>B(a.id)},{default:m(()=>n[14]||(n[14]=[w(" Ajouter une tâche ")])),_:2},1032,["onClick"])])),b.value?k("",!0):(r(),o("div",te,[v(g(h),{href:"/spares/create",class:"btn btn-secondary my-1",onClick:c=>D(a.id)},{default:m(()=>n[15]||(n[15]=[w(" Ajouter une pièce ")])),_:2},1032,["onClick"])])),b.value?k("",!0):(r(),o("div",ne,[v(g(h),{href:"#",class:"btn btn-secondary my-1",onClick:z(c=>U(a.id),["prevent"])},{default:m(()=>n[16]||(n[16]=[w(" Ticket ")])),_:2},1032,["onClick"])]))],2))),128)),t("div",ae,[t("ul",le,[(r(!0),o($,null,F(g(_),(a,c)=>(r(),o("a",{href:"#",class:s(["btn btn-secondary",{active:a.active,disable:!a.url}]),key:c,innerHTML:a.label,onClick:oe=>V(a)},null,10,se))),128))]),T(t("select",{"onUpdate:modelValue":n[10]||(n[10]=a=>C.value=a),onChange:y,class:"select-pagination"},n[17]||(n[17]=[t("option",{value:"5"},"5",-1),t("option",{value:"10"},"10",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1),t("option",{value:"200"},"200",-1),t("option",{value:"500"},"500",-1),t("option",{value:"1000"},"1000",-1)]),544),[[q,C.value]])])])])]),_:1})],64))}};export{ge as default};
